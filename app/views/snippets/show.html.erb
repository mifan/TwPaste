<div id="content">
  <%= success_messages %>
  <h2>
   # <%= @snippet.id %>  <%=h @snippet.title %>
   <%= image_tag("icons/private.gif",:alt => "Private") if @snippet.private %>
  </h2>
<div id="snippet_show">    
    <div class="snippet_code">        
        <%=@snippet.code_formatted_show %>
    </div>
  <% if !@snippet.desc.blank? %>
  <div class="desc">
    <%= format_comment @snippet.desc %>
  </div>
  <% end  %>
    <div class="comments" id="comments">
      <h2>Comments<span class="count">(<%= @snippet.comments_count %>)</span></h2>
      <%=render :partial => 'comment' , :collection => @snippet.comments %>
    </div>    
    <div id="comment_new">
      <% if current_user %>
      <div class="form">
          <% form_for @comment,:url => "/code/#{params[:id]}/comment" do |f|%>
          <%= f.error_messages %>
          <div class="row">
             <%= f.label :comment,"Comment:" %><br />
             <%= f.text_area :comment ,:class => "text", :rows => 4, :cols => 50 %>
          </div>
          <div class="row">
            <%= f.submit "Post comment", :disable_with => 'Submiting...' %>
          </div>
        <% end %>
      </div>
      <% else %>
          Please <a href="/login?return_to=<%=request.url%>">log in</a> to comment.
      <% end %>
    </div>
</div>
</div>
<div id="right">
    <div class="box">
        <label>Theme:</label><br />
        <select name="theme" onchange="this.form.submit();">          
          <% if !APP_THEMES.blank? %>
            <% i = 0 %>
            <% for item in APP_THEMES %>
              <option value="<%= item.parameterize('_').to_s %>"<%= ' selected="selected"' if @theme_name == "#{item.parameterize('_').to_s}" %>><%= APP_THEMES_NAMES[i] %></option>
          <% i += 1 %>
            <% end %>
          <% else %>
            <option value="idle">IDLE</option>
          <% end %>
        </select>
    </div>
 
    <div class="box">
          <%= link_to "Raw", :controller => "snippets", :action => "show", :format => :raw, :id => @snippet.id %>
          <span style="color: rgb(153, 153, 153);">or</span>
          <%= link_to "HTML Code", :controller => "snippets", :action => "show", :format => :code, :id => @snippet.id %>
    </div>
    <p class="box">
        <label>Author</label><br />
        <%= link_to (h @snippet.user.login), :controller => "snippets", :action => "index", :login => @snippet.user.login %>
    </p>

    <p class="box">
        <label>Pasted</label><br />
        <%= time_ago_in_words(@snippet.created_at) %> Ago
    </p>
    <p class="box">
        <label>Language</label><br />
        <%= link_to (h @snippet.language.name), :controller => "snippets", :action => "index", :lang => @snippet.language.slug %>
    </p>
    <p class="box">
        <label>File size<label><br />
        <%=h @snippet.size_kb %>
    </p>
  <p class="box">
    <label>Views count<label><br />
    <%=h @snippet.views_count_s  %>
  </p>
    <p class="box tags">
        <% if !@snippet.tags.blank? %>
        <label>Tags</label><br />        
          <% for item in @snippet.tags %>
            <span class="tag_name"><%= link_to (h item.name), :controller => "snippets", :action => "index", :tag => (h item.name.downcase) %></span>
          <% end %>        
        <% end %>
    </p>
    <% if has_permission(@snippet) %>
    <p class="box operate">
            <%= link_to 'Edit', edit_snippet_path(@snippet) %> | <%= link_to 'Destroy', @snippet, :confirm => 'Are you sure?', :method => :delete %>
    </p>
    <% end %>
</div>
