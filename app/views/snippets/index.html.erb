<!-- content_for :head do >
    <= auto_discovery_link_tag(:rss, :action => "index", :type => "feed") >
< end >
-->
 

<div id="content">
<h2><%= @sub_title %> <%= link_to (image_tag("feed.gif",:alt => "Subscription code",:class => "feed")), :action => "index", :type => "feed"  %></h2>
<div id="snippets">
  <div class="total">
    There have <%= @snippets_count %> pasites 
  </div>
  <% @snippets.each do |snippet| %>
  <div class="item clearfix">
    <div class="when">      
      <span class="typo_date" title="<%= snippet.created_at %>"><%= snippet.created_at.to_s(:short_time) %></span>
        by <%= link_to snippet.user.login,:action => "index", :login => snippet.user.login %>
    </div>
    <div class="link">      
      #<%= snippet.id %> <%= link_to (truncate(h(snippet.title),:length => 50)), snippet %> 
            <span class="lang"> [<%= snippet.language.name %>]</span>
            <span  class="count">(<%= snippet.line_count %> lines,<%= snippet.comments_count %> comments)</span>
    </div>
    <div class="summary">
      <%= snippet.summary_formatted_show %>
    </div>  
  </div>
  <% end %>  
  <div class="pages">
    <%= will_paginate @snippets %>
  </div>
</div>
</div>

<div id="right">
  <% if current_user %>
  <div class="box" id="right_profile">
    <h3>Profile</h3>
    <ul>
      <li>        
        <img src="<%= current_user.avatar_url %>" width="48px" height="48px" alt="<%=current_user.login %>'s face" />
      </li>   
      <li><label>Twitter Name:</label> <%=h current_user.login %></li>
      <li class="clearfix">
             <%= current_user.snippets_count %> <label>snippts</label>, <%= current_user.comments_count %> <label>comments</label>
      </li>
 
    </ul>
  </div>    
  <% else %>
  <div class="box" id="right_top_languages">    
    <h3>Top Languages</h3>
    <ul>
      <% if !@top_languages.blank? %>
        <% for item in @top_languages%>
          <li><%= link_to (h item.name), :controller => "snippets", :action => "index", :lang => item.slug %> <span class="count">(<%= item.snippets_count %>)</span></li>
        <% end %>
      <% end %>      
    </ul>
  </div>  
    <% if @snippets.size > 1 %>
  <div class="box" id="right_top_users">
    <h3>Top Users</h3>
    <ul>
      <% if !@top_users.blank? %>
        <% for item in @top_users  %>
          <li><%= link_to (h item.name), :controller => "snippets", :action => "index", :login => item.login %> <span class="count">(<%= item.snippets_count %>)</span></li>
        <% end %>      
      <% end %>      
    </ul>
  </div>
    <% end %>
    <% if @snippets.size > 3 %>
        <div class="box" id="recent_comments">
        <h3>Recent Comments</h3>
        <ul>
          <% if !@recent_comments.blank? %>
            <% for item in @recent_comments  %>
              <li><%= link_to (truncate(h(item.title),:length => 10)), :controller => "snippets", :action => "show", :id => item.commentable_id %>: <%= truncate(h(item.comment),:length => 40) %></li>
            <% end %>      
          <% end %>      
        </ul>
      </div>
    <% end %>
  <% end %>
</div>
